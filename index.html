<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOTOCA WebRadio - Exp√©rience Musicale Unique</title>
    <style>
        /* Styles CSS (Identiques √† la version pr√©c√©dente avec l'overlay) */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #121212; color: #ffffff; padding: 20px; max-width: 800px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; padding: 20px 0; border-bottom: 1px solid #333; }
        h1 { font-size: 2.5em; margin-bottom: 10px; color: #5c67f2; }
        .radio-info { max-width: 600px; margin: 0 auto 30px auto; text-align: center; line-height: 1.6; color: #aaa; }
        .genre-buttons { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 25px; }
        .genre-button { background-color: #333; color: white; border: none; border-radius: 20px; padding: 10px 20px; font-size: 0.9em; cursor: pointer; transition: all 0.3s ease; }
        .genre-button:hover { background-color: #5c67f2; transform: translateY(-2px); }
        .genre-button.active { background-color: #5c67f2; }
        .loading-message { text-align: center; padding: 60px 20px; font-style: italic; color: #888; min-height: 240px; display: flex; justify-content: center; align-items: center;}
        .iframe-container { width: 100%; margin-bottom: 20px; background-color: #222; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); min-height: 240px; }
        #suno-iframe { display: block; border: none; width: 100%; height: 240px; }
        .controls { display: flex; justify-content: center; gap: 15px; margin: 25px 0; }
        .button-next, .button-history { display: inline-block; background-color: #5c67f2; color: white; padding: 12px 24px; border: none; border-radius: 25px; font-size: 1em; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(92, 103, 242, 0.3); }
        .button-next:hover, .button-history:hover { background-color: #4a54cc; transform: translateY(-2px); box-shadow: 0 6px 8px rgba(92, 103, 242, 0.4); }
        .button-next:active, .button-history:active { transform: translateY(0); box-shadow: 0 2px 4px rgba(92, 103, 242, 0.2); }
        .history-container { margin-top: 30px; padding: 15px; background-color: #222; border-radius: 8px; display: none; }
        .history-container h3 { margin-bottom: 15px; color: #ccc; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .history-list { list-style-type: none; padding-left: 0; /* Reset */ }
        .history-list li { padding: 8px 0; border-bottom: 1px solid #333; color: #aaa; }
        .history-list li:last-child { border-bottom: none; }
        .support-section { text-align: center; margin: 40px 0; padding: 20px; background-color: rgba(92, 103, 242, 0.1); border-radius: 8px; border: 1px solid rgba(92, 103, 242, 0.3); }
        .support-title { font-size: 1.5em; color: #5c67f2; margin-bottom: 15px; }
        .support-text { margin-bottom: 20px; line-height: 1.5; color: #aaa; }
        .support-buttons { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .support-button { display: inline-block; background-color: #f28c31; color: white; padding: 10px 20px; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease; }
        .support-button:hover { transform: translateY(-3px); box-shadow: 0 4px 8px rgba(242, 140, 49, 0.4); }
        .paypal-button { background-color: #0070ba; }
        .attribution { margin-top: 40px; padding-top: 20px; font-size: 0.8em; color: #666; text-align: center; border-top: 1px solid #333; }
        .attribution a { color: #5c67f2; text-decoration: none; }
        .attribution a:hover { text-decoration: underline; }
        .now-playing { text-align: center; margin-top: 15px; font-size: 0.9em; color: #aaa; min-height: 1.2em; }
        #initial-play-overlay { position: relative; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px 20px; background-color: rgba(34, 34, 34, 0.8); border-radius: 8px; cursor: pointer; min-height: 240px; text-align: center; transition: opacity 0.3s ease-out; /* Chang√© ease->ease-out */}
        #initial-play-overlay.hidden { opacity: 0; pointer-events: none; position: absolute; /* Pour ne plus prendre de place */}
        #start-radio-button { background-color: #5c67f2; color: white; padding: 15px 30px; border: none; border-radius: 30px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s ease; margin-top: 15px; }
        #start-radio-button:hover { background-color: #4a54cc; transform: scale(1.05); }
        .overlay-icon { font-size: 3em; color: #5c67f2; margin-bottom: 10px; }
        .overlay-text { font-size: 0.9em; color: #ccc; margin-top: 15px; }
        #iframe-target { display: none; min-height: 240px; }
        @media (max-width: 600px) { body { padding: 10px; } h1 { font-size: 1.8em; } .controls { flex-direction: column; } .genre-buttons { gap: 8px; } .genre-button { padding: 8px 16px; font-size: 0.8em; } #start-radio-button { padding: 12px 24px; font-size: 1em;} .overlay-icon { font-size: 2.5em;} }
    </style>
</head>
<body>
    <header>
        <h1>SOTOCA WebRadio</h1>
        <p class="radio-info">Une exp√©rience musicale unique √† chaque visite ....</p>
    </header>

    <div class="genre-buttons">
        <button class="genre-button active">Tous les styles</button>
        <button class="genre-button">Pop</button>
        <button class="genre-button">Rock</button>
        <button class="genre-button">Jazz</button>
		<button class="genre-button">Mantra</button>
        <button class="genre-button">Classique</button>
        <button class="genre-button">√âlectronique</button>
    </div>

    <div class="iframe-container" id="player-container">
        <div id="initial-play-overlay">
            <span class="overlay-icon">üéµ</span>
            <button id="start-radio-button">Lancer la Radio</button>
            <p class="overlay-text">(Cliquez pour d√©marrer)</p>
        </div>
        <div id="iframe-target">
           {/* L'iframe sera inject√©e ici */}
        </div>
    </div>

    <div class="now-playing">
        <p id="now-playing-text"></p>
    </div>

    <div class="controls">
        <button class="button-next" id="next-track">Morceau suivant</button>
        <button class="button-history" id="toggle-history">Voir l'historique</button>
    </div>

    <div class="history-container" id="history-container">
        <h3>Historique de lecture</h3>
        <ul class="history-list" id="history-list"></ul>
    </div>

    <div class="support-section">
        <h2 class="support-title">SOUTENIR SOTOCA WEBRADIO</h2>
        <p class="support-text">Cette radio est sans publicit√© et enti√®rement gratuite. Votre soutien nous permet de continuer √† offrir une exp√©rience musicale unique et sans interruption.</p>
        <div class="support-buttons">
            <a href="https://www.paypal.com/donate" target="_blank" class="support-button paypal-button">Faire un don via PayPal</a>
            <a href="https://www.tipeee.com" target="_blank" class="support-button">Nous soutenir sur Tipeee</a>
        </div>
    </div>

    <div class="attribution">
        <p>Tous les morceaux sont fournis par <a href="https://suno.com" target="_blank">Suno</a> sous licence libre. Cette radio est un projet ind√©pendant et n'est pas affili√©e √† Suno.</p>
    </div>

    <script>
        // ==============================================================
        // == CONFIGURATION - √Ä REMPLIR SOIGNEUSEMENT ==
        // ==============================================================
        const sunoTracks = [
            // EXEMPLES - REMPLACEZ PAR VOS DONN√âES R√âELLES ET VALIDES
            { id: "b34a68c5-d549-435f-9132-7e1af773ad3d", title: "Jazz Cool Evening", artist: "Suno AI", genre: "Jazz", duration: 191 }, // Dur√©e en secondes
            { id: "dd8ca77f-20d8-46fa-9c41-97aad8d2c5f3", title: "Smooth Night Ride", artist: "Suno AI", genre: "Jazz", duration: 239 },
            { id: "32cefad4-9525-4a91-8c13-c782bdd2ab76", title: "Upbeat Morning Cafe", artist: "Suno AI", genre: "Jazz", duration: 74 }, // Attention dur√©e courte ici
			{ id: "948b8276-6714-460f-b526-033354e094ce", title: "Cancer", artist: "Joy'elle", genre: "Pop", duration: 158 },
			{ id: "057fa758-048a-4faf-9bb8-173d4d16bd84", title: "Sarvesham Mantra", artist: "Mantras Of The Mystics", genre: "Mantra", duration: 321 },
            

            // Ajoutez ici AUTANT de morceaux que vous voulez,
            // MAIS ASSUREZ-VOUS que chaque 'id' est VALIDE et chaque 'duration' est CORRECTE (en secondes)
            // { id: "VOTRE_ID_SUNO_VALID", title: "Titre", artist: "Artiste", genre: "Genre", duration: SECONDES },
        ];
        // ==============================================================
        // == FIN CONFIGURATION ==
        // ==============================================================


        // --- Variables globales ---
        let currentGenre = "Tous les styles";
        let currentTrackId = null;
        let nextTrackTimer = null;
        let radioHasStarted = false; // Indicateur pour le premier lancement

        // --- √âl√©ments du DOM (pour √©viter les recherches r√©p√©t√©es) ---
        const genreButtonsContainer = document.querySelector('.genre-buttons');
        const playerContainer = document.getElementById('player-container');
        const initialOverlay = document.getElementById('initial-play-overlay');
        const startButton = document.getElementById('start-radio-button');
        const iframeTarget = document.getElementById('iframe-target');
        const nowPlayingText = document.getElementById('now-playing-text');
        const nextTrackButton = document.getElementById('next-track');
        const toggleHistoryButton = document.getElementById('toggle-history');
        const historyContainer = document.getElementById('history-container');
        const historyList = document.getElementById('history-list');


        // --- Fonctions Utilitaires ---

        function getPlayHistory() {
            try {
                const history = localStorage.getItem('sunoRadioHistory');
                return history ? JSON.parse(history) : [];
            } catch (e) {
                console.error("Erreur lors de la lecture de l'historique depuis localStorage:", e);
                return [];
            }
        }

        function updatePlayHistory(trackId) {
            if (!trackId) return;
            let history = getPlayHistory();
            const track = sunoTracks.find(t => t.id === trackId);

            if (track) {
                // Mettre √† jour l'affichage "En cours"
                nowPlayingText.textContent = `En cours: ${track.title || 'Titre inconnu'} par ${track.artist || 'Artiste inconnu'}`;

                // Ajouter √† l'historique seulement si diff√©rent du dernier √©l√©ment
                if (history.length === 0 || history[0].id !== trackId) {
                    history.unshift({
                        id: trackId,
                        title: track.title || `Morceau ${track.id.substring(0, 6)}`,
                        artist: track.artist || "Inconnu",
                        genre: track.genre || "Inconnu",
                        timestamp: new Date().toISOString()
                    });
                    // Limiter la taille de l'historique
                    if (history.length > 15) { // Un peu plus grand ?
                        history = history.slice(0, 15);
                    }
                    try {
                        localStorage.setItem('sunoRadioHistory', JSON.stringify(history));
                        updateHistoryDisplay(); // Mettre √† jour l'affichage si l'historique est visible
                    } catch (e) {
                        console.error("Erreur lors de la sauvegarde de l'historique dans localStorage:", e);
                    }
                }
            } else {
                console.warn(`Piste avec ID ${trackId} non trouv√©e dans sunoTracks pour l'historique.`);
                nowPlayingText.textContent = 'Chargement...';
            }
        }

        function updateHistoryDisplay() {
            if (!historyContainer || !historyList) return; // V√©rifier si les √©l√©ments existent
            // Mettre √† jour seulement si l'historique est visible
            if (historyContainer.style.display !== 'block') {
                return;
            }

            const history = getPlayHistory();
            historyList.innerHTML = ''; // Vider

            if (history.length === 0) {
                historyList.innerHTML = '<li>Aucun morceau dans l\'historique.</li>';
            } else {
                history.forEach(item => {
                    const li = document.createElement('li');
                    try {
                         const date = new Date(item.timestamp);
                         const time = date.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
                         li.textContent = `${item.title || '?'} par ${item.artist || '?'} (${item.genre || '?'}) - ${time}`;
                    } catch (e) {
                         li.textContent = `${item.title || '?'} par ${item.artist || '?'} - Heure inconnue`; // Fallback
                    }
                    historyList.appendChild(li);
                });
            }
        }

        function getTracksByGenre(genre) {
            if (genre === "Tous les styles" || !genre) {
                return [...sunoTracks]; // Retourne une copie
            } else {
                return sunoTracks.filter(track => track.genre === genre);
            }
        }

        function selectRandomTrack() {
            const history = getPlayHistory();
            let availableTracks = getTracksByGenre(currentGenre);

            if (availableTracks.length === 0) {
                console.warn(`Aucun morceau trouv√© pour le genre "${currentGenre}". Retour √† "Tous les styles".`);
                currentGenre = "Tous les styles";
                updateGenreButtons();
                availableTracks = getTracksByGenre(currentGenre);
            }

            if (availableTracks.length === 0) {
                console.error("Aucun morceau disponible dans la liste sunoTracks ! V√©rifiez la configuration.");
                return null; // Important de retourner null si rien n'est dispo
            }

            // √âviter les 2 derniers jou√©s si assez de choix
            if (history.length > 0 && availableTracks.length > 2) {
                const recentTrackIds = [...new Set(history.slice(0, 2).map(item => item.id))];
                const filteredTracks = availableTracks.filter(track => !recentTrackIds.includes(track.id));
                if (filteredTracks.length > 0) {
                    availableTracks = filteredTracks;
                    // console.log("Exclusion des 2 derniers morceaux jou√©s.");
                }
            }

            const randomIndex = Math.floor(Math.random() * availableTracks.length);
            // console.log(`S√©lection al√©atoire parmi ${availableTracks.length} pistes.`);
            return availableTracks[randomIndex];
        }

        function updateGenreButtons() {
            const buttons = genreButtonsContainer.querySelectorAll('.genre-button');
            buttons.forEach(button => {
                button.classList.toggle('active', button.textContent === currentGenre);
            });
        }


        // --- Fonctions principales de lecture ---

        function loadTrack(track) {
            // V√©rification cruciale au d√©but
            if (!track || typeof track !== 'object' || !track.id) {
                console.error("ERREUR CRITIQUE: Tentative de chargement d'une piste invalide ou nulle.", track);
                iframeTarget.innerHTML = '<p class="loading-message">Erreur: Impossible de charger cette piste.</p>';
                 nowPlayingText.textContent = 'Erreur de chargement';
                // Stopper le timer s'il y en avait un
                if (nextTrackTimer) clearTimeout(nextTrackTimer);
                nextTrackTimer = null;
                return; // Arr√™ter ici !
            }

            console.log(`[loadTrack] Tentative de chargement: ${track.title} (ID: ${track.id})`);
            currentTrackId = track.id; // Mettre √† jour l'ID courant

            // Annuler le minuteur pr√©c√©dent s'il existe
            if (nextTrackTimer) {
                clearTimeout(nextTrackTimer);
                console.log("[loadTrack] Minuteur pr√©c√©dent annul√©.");
                nextTrackTimer = null;
            }

            // Afficher la zone de l'iframe (elle pourrait √™tre cach√©e si erreur pr√©c√©dente)
            iframeTarget.style.display = 'block';
            // Ins√©rer l'iframe
            iframeTarget.innerHTML = `
                <iframe id="suno-iframe"
                        title="Lecteur Suno pour ${track.title || 'morceau'}"
                        src="https://suno.com/embed/${track.id}?autoplay=true"
                        width="100%" height="240" style="border:none;"
                        allow="autoplay"
                        onerror="console.error('ERREUR: Iframe Suno n\\'a pas pu charger pour ID ${track.id}'); iframeTarget.innerHTML = '<p class=loading-message>Erreur chargement iframe</p>';">
                    <p>Votre navigateur ne supporte pas les iframes.</p>
                </iframe>`;
             console.log("[loadTrack] Iframe inject√©e pour:", track.id);

            updatePlayHistory(track.id); // Mettre √† jour l'historique et "En cours"

            // D√©marrer le minuteur pour le prochain morceau si dur√©e valide
            if (track.duration && typeof track.duration === 'number' && track.duration > 0) {
                const delay = (track.duration * 1000) + 3000; // +3s de marge
                console.log(`[loadTrack] Prochain morceau programm√© via timer dans ${delay / 1000}s.`);
                nextTrackTimer = setTimeout(() => {
                    console.log("[Timer] D√©lai √©coul√© pour", currentTrackId, "-> Appel de loadNextTrack.");
                    loadNextTrack();
                }, delay);
            } else {
                console.warn(`[loadTrack] Dur√©e manquante ou invalide pour ${track.id} (${track.title}). Pas d'encha√Ænement auto apr√®s ce morceau. Dur√©e trouv√©e:`, track.duration);
                // L'encha√Ænement s'arr√™te ici naturellement.
            }
        }

        function loadNextTrack() {
            // S√©curit√©: Ne rien faire si la radio n'a pas √©t√© d√©marr√©e explicitement
            if (!radioHasStarted) {
                 console.warn("[loadNextTrack] Bloqu√© - la radio n'a pas √©t√© d√©marr√©e par l'utilisateur.");
                 return;
            }

            console.log("[loadNextTrack] D√©but du processus de chargement du prochain morceau...");
            iframeTarget.style.display = 'block'; // S'assurer que c'est visible
            iframeTarget.innerHTML = '<p class="loading-message">Chargement du prochain morceau...</p>';
            nowPlayingText.textContent = 'S√©lection en cours...';

            // Utiliser un setTimeout pour d√©coupler l√©g√®rement la s√©lection/chargement
            setTimeout(() => {
                console.log("[loadNextTrack] S√©lection d'un morceau al√©atoire...");
                const trackToLoad = selectRandomTrack();

                // V√©rifier si selectRandomTrack a retourn√© quelque chose
                if (trackToLoad) {
                     console.log("[loadNextTrack] Morceau s√©lectionn√©:", trackToLoad.title, "-> Appel de loadTrack.");
                    loadTrack(trackToLoad); // Charger le morceau trouv√©
                } else {
                    // Cas o√π selectRandomTrack n'a rien retourn√© (devrait √™tre rare si sunoTracks n'est pas vide)
                    console.error("[loadNextTrack] ERREUR: selectRandomTrack n'a retourn√© aucun morceau ! V√©rifiez la liste sunoTracks et la logique de filtrage.");
                    iframeTarget.innerHTML = '<p class="loading-message">Erreur : Aucun morceau trouv√©.</p>';
                    nowPlayingText.textContent = 'Erreur de s√©lection';
                     // Stopper le timer s'il y en avait un
                     if (nextTrackTimer) clearTimeout(nextTrackTimer);
                     nextTrackTimer = null;
                }
            }, 100); // Court d√©lai
        }

        // --- Gestion du premier d√©marrage (lanc√© par clic) ---
        function startRadioFirstTime() {
             if (radioHasStarted) {
                 console.log("[startRadioFirstTime] D√©j√† d√©marr√©, ne fait rien.");
                 return; // S√©curit√© pour √©viter double lancement
             }
             console.log("[startRadioFirstTime] Premier clic d√©tect√© ! Initialisation de la radio...");
             radioHasStarted = true; // *** Marquer comme d√©marr√© ***

             // Cacher l'overlay et montrer la zone iframe de mani√®re fiable
             if (initialOverlay) {
                  initialOverlay.classList.add('hidden');
                  // S'assurer qu'il dispara√Æt visuellement m√™me si la classe CSS a un d√©lai
                  initialOverlay.style.display = 'none';
             }
             if(iframeTarget) {
                iframeTarget.style.display = 'block';
             } else {
                 console.error("ERREUR: Element #iframe-target non trouv√© !");
                 return;
             }


             console.log("[startRadioFirstTime] Appel de loadNextTrack pour charger le premier morceau...");
             // Charger le premier morceau MAINTENANT
             loadNextTrack();

             // Optionnel : D√©sactiver les √©couteurs du premier clic pour √©viter re-d√©clenchement
             if (initialOverlay) initialOverlay.removeEventListener('click', startRadioFirstTime);
             // Inutile de retirer celui du bouton car il est DANS l'overlay
        }


        // --- Initialisation des √©couteurs d'√©v√©nements ---

        function setupEventListeners() {
            // Clic sur l'overlay pour d√©marrer
            if (initialOverlay) {
                initialOverlay.addEventListener('click', startRadioFirstTime);
                console.log("[Init] √âcouteur ajout√© sur l'overlay de d√©marrage.");
            } else {
                 console.error("[Init] ERREUR: Overlay de d√©marrage #initial-play-overlay non trouv√© !");
            }

            // Clics sur les boutons de genre
            if (genreButtonsContainer) {
                genreButtonsContainer.addEventListener('click', (event) => {
                    if (event.target.classList.contains('genre-button')) {
                        const selectedGenre = event.target.textContent;
                        console.log(`[Event] Bouton de genre cliqu√©: ${selectedGenre}`);

                         // Si la radio n'a pas encore d√©marr√©, ce clic la d√©marre AUSSI !
                        if (!radioHasStarted) {
                             console.log("[Event] Clic sur genre d√©marre la radio...");
                             startRadioFirstTime(); // D√©marre la radio
                             // Attendre un peu que le premier morceau ait une chance de commencer √† charger
                             // avant de forcer le changement de genre et recharger.
                             setTimeout(() => {
                                 if (selectedGenre !== currentGenre) { // V√©rifier si c'est un nouveau genre
                                      console.log(`[Event] Changement de genre vers: ${selectedGenre}`);
                                     currentGenre = selectedGenre;
                                     updateGenreButtons();
                                     loadNextTrack(); // Charger un morceau du nouveau genre
                                 }
                             }, 300); // D√©lai un peu plus long
                        } else {
                            // Comportement normal si d√©j√† d√©marr√©
                            if (selectedGenre !== currentGenre) {
                                console.log(`[Event] Changement de genre vers: ${selectedGenre}`);
                                currentGenre = selectedGenre;
                                updateGenreButtons();
                                loadNextTrack(); // Charger un morceau du nouveau genre
                            } else {
                                console.log("[Event] Clic sur le genre d√©j√† actif, ne fait rien.");
                            }
                        }
                    }
                });
                 console.log("[Init] √âcouteur ajout√© sur le conteneur des boutons de genre.");
            } else {
                 console.error("[Init] ERREUR: Conteneur de boutons .genre-buttons non trouv√© !");
            }


            // Clic sur bouton "Morceau suivant"
            if (nextTrackButton) {
                nextTrackButton.addEventListener('click', () => {
                    console.log("[Event] Bouton 'Morceau Suivant' cliqu√©.");
                     // Si la radio n'a pas encore d√©marr√©, ce clic la d√©marre !
                     if (!radioHasStarted) {
                          console.log("[Event] Clic sur 'Suivant' d√©marre la radio...");
                         startRadioFirstTime();
                     } else {
                         // Comportement normal si d√©j√† d√©marr√©
                         loadNextTrack();
                     }
                });
                 console.log("[Init] √âcouteur ajout√© sur le bouton 'Suivant'.");
            } else {
                 console.error("[Init] ERREUR: Bouton #next-track non trouv√© !");
            }


            // Clic sur bouton "Voir/Cacher l'historique"
            if (toggleHistoryButton && historyContainer) {
                toggleHistoryButton.addEventListener('click', function() {
                    const isVisible = historyContainer.style.display === 'block';
                    historyContainer.style.display = isVisible ? 'none' : 'block';
                    this.textContent = isVisible ? "Voir l'historique" : "Cacher l'historique";
                    if (!isVisible) {
                        // Mettre √† jour l'affichage seulement quand on l'ouvre
                        updateHistoryDisplay();
                    }
                });
                console.log("[Init] √âcouteur ajout√© sur le bouton d'historique.");
            } else {
                 console.error("[Init] ERREUR: Bouton #toggle-history ou conteneur #history-container non trouv√© !");
            }

        }

        // --- CHARGEMENT INITIAL DE LA PAGE ---
        document.addEventListener('DOMContentLoaded', () => {
            console.log("===============================");
            console.log("DOM Charg√©. Initialisation de la radio...");
            console.log("===============================");

            // V√©rifier si la liste de pistes est vide
             if (!sunoTracks || sunoTracks.length === 0) {
                console.error("############################################################");
                console.error("ERREUR FATALE: La liste 'sunoTracks' est vide ou non d√©finie !");
                console.error("Impossible de d√©marrer la radio. V√©rifiez la configuration.");
                console.error("############################################################");
                if(initialOverlay) {
                    initialOverlay.innerHTML = '<p class="loading-message" style="color: red;">Erreur: Liste de morceaux vide !</p>';
                }
                return; // Bloquer l'initialisation
            }

            updateGenreButtons();    // Met √† jour l'affichage des boutons de genre
            updateHistoryDisplay();  // Tente d'afficher l'historique (peut √™tre vide)
            setupEventListeners();   // Met en place tous les √©couteurs de clics

            console.log("[Init] Radio pr√™te. Attente du clic utilisateur sur l'overlay pour d√©marrer.");
            // IMPORTANT: Ne PAS appeler loadNextTrack() ici. La radio d√©marrera avec startRadioFirstTime().
        });

    </script>
</body>
</html>
